## CVE-2018-9582

-   Status: Completed.

-   Description: In PackageInstaller there is a possible bypass of the unknown source warning due to a confused deputy scenario. This could lead to local escalation of privilege with no additional execution privileges needed. User interaction is not needed for exploitation.

-   Type: EoP

-   Severity: High

-   Links:

1. [NVD](https://nvd.nist.gov/vuln/detail/CVE-2018-9582)
2. [Google Source](https://android.googlesource.com/platform/packages/apps/PackageInstaller/+/ab39f6cb7afc48584da3c59d8e2a5e1ef121aafb)
3. [Usage of PackageInstaller](https://stackoverflow.com/questions/26884956/how-to-install-update-remove-apk-using-packageinstaller-class-in-android-l)

-   Exploit: Use a spoofed sessionId to install an app acting like a priviledged source.

-   Patch: For Android 7.0 and newer the apk must be supplied through a FileProvider, which can't be accessed through Virtualapp because the UID is not the owner
