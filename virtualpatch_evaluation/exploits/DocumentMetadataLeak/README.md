## CVE-2020-0239

-   Status: Completed.

-   Description: In getDocumentMetadata of DocumentsContract.java, there is a possible disclosure of location metadata from a file due to a permissions bypass. This could lead to local information disclosure from a file (eg. a photo) containing location metadata with no additional execution privileges needed. User interaction is not needed for exploitation.

-   Type: ID

-   Severity: High

-   Links:

1. [NVD](https://nvd.nist.gov/vuln/detail/CVE-2020-0239)
2. [Google source](https://android.googlesource.com/platform/frameworks/base/+/556de438237965857fde874d22aff0c4232d4d99)
3. [Access documents](https://developer.android.com/training/data-storage/shared/documents-files)
4. [Access hidden api](https://stackoverflow.com/questions/55970137/bypass-androids-hidden-api-restrictions)

-   Exploit: Get the metadata of pictures from the camera roll

-   Patch: Like google source but since my exploit doesn't use DocumentProvider I also added a patch for the method getDocumentMetadata in DocumentsContract to enforce the check of read permissions.
